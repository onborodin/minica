#!/usr/local/bin/perl

use Crypt::OpenSSL::Random;
use Crypt::OpenSSL::RSA;
use Crypt::OpenSSL::CA;
use Crypt::OpenSSL::X509;
use Mojo::Util qw(b64_encode b64_decode md5_sum dumper);


my $pemcrl = <<EOF;
-----BEGIN X509 CRL-----
MIIM8jCCC9owDQYJKoZIhvcNAQELBQAwbTELMAkGA1UEBhMCUlUxCjAIBgNVBAgT
AS4xCjAIBgNVBAcTAS4xEDAOBgNVBAoTB0xhenVyaXQxEzARBgNVBAMTCkxhenVy
aXQgQ0ExHzAdBgkqhkiG9w0BCQEWEHJvb3RAbGF6dXJpdC5jb20XDTE3MDEyNDE2
MjAyMVoXDTM3MDExOTE2MjAyMVowggs6MBICAUYXDTEyMDcxODExMjAxN1owEgIB
RxcNMTIwNzE4MTEyMDE5WjASAgFIFw0xMjA3MTgxMTIwMjBaMBMCAgCGFw0xMjA3
MTgxMTEyMDBaMBMCAgCeFw0xMjA3MTkwOTM3NDNaMBMCAgGeFw0xNzAxMjQwOTM5
MDBaMBMCAgNWFw0xNzAxMjQwOTM5MDBaMBMCAgNXFw0xNzAxMjQwOTM5MDBaMBMC
AgNYFw0xNzAxMjQwOTM5MDBaMBMCAgNoFw0xNzAxMjQwOTM5MDBaMBMCAgNpFw0x
NzAxMjQwOTM5MDBaMBMCAgNqFw0xNzAxMjQwOTM5MDBaMBMCAgOLFw0xNzAxMjQw
OTM5MDBaMBMCAgOMFw0xNzAxMjQwOTM5MDFaMBMCAgONFw0xNzAxMjQwOTM5MDFa
MBMCAgOOFw0xNzAxMjQwOTM5MDFaMBMCAgOPFw0xNzAxMjQwOTM5MDFaMBMCAgOQ
Fw0xNzAxMjQwOTM5MDFaMBMCAgORFw0xNzAxMjQwOTM5MDFaMBMCAgOSFw0xNzAx
MjQwOTM5MDFaMBMCAgOTFw0xNzAxMjQwOTM5MDFaMBMCAgOUFw0xNzAxMjQwOTM5
MDFaMBMCAgPIFw0xNzAxMjQwOTM5MDFaMBMCAgPJFw0xNzAxMjQwOTM5MDFaMBMC
AgPSFw0xNzAxMjQwOTM5MDFaMBMCAgPTFw0xNzAxMjQwOTM5MDFaMBMCAgPUFw0x
NzAxMjQwOTM5MDFaMBMCAgPVFw0xNzAxMjQwOTM5MDFaMBMCAgPWFw0xNzAxMjQw
OTM5MDFaMBMCAgPXFw0xNzAxMjQwOTM5MDFaMBMCAgPcFw0xNzAxMjQwOTM5MDJa
MBMCAgPdFw0xNzAxMjQwOTM5MDJaMBMCAgPeFw0xNzAxMjQwOTM5MDJaMBMCAgPf
Fw0xNzAxMjQwOTM5MDJaMBMCAgPhFw0xNzAxMjQwOTM5MDJaMBMCAgPiFw0xNzAx
MjQwOTM5MDJaMBMCAgPjFw0xNzAxMjQwOTM5MDJaMBMCAgPkFw0xNzAxMjQwOTM5
MDJaMBMCAgPlFw0xNzAxMjQwOTM5MDJaMBMCAgPmFw0xNzAxMjQwOTM5MDJaMBMC
AgPnFw0xNzAxMjQwOTM5MDJaMBMCAgPqFw0xNzAxMjQwOTM5MDJaMBMCAgPrFw0x
NzAxMjQwOTM5MDJaMBMCAgPtFw0xNzAxMjQwOTM5MDJaMBMCAgPuFw0xNzAxMjQw
OTM5MDJaMBMCAgPvFw0xNzAxMjQwOTM5MDJaMBMCAgPwFw0xNzAxMjQwOTM5MDJa
MBMCAgPxFw0xNzAxMjQwOTM5MDJaMBMCAgP1Fw0xNzAxMjQwOTM5MDNaMBMCAgP2
Fw0xNzAxMjQwOTM5MDNaMBMCAgP3Fw0xNzAxMjQwOTM5MDNaMBMCAgQpFw0xNzAx
MjQwOTM5MDNaMBMCAgSPFw0xNzAxMjQwOTM5MDNaMBMCAgSWFw0xNzAxMjQwOTM5
MDNaMBMCAgSaFw0xNzAxMjQwOTM5MDNaMBMCAgSeFw0xNzAxMjQwOTM5MDNaMBMC
AgSfFw0xNzAxMjQwOTM5MDNaMBMCAgS8Fw0xNzAxMjQwOTM5MDNaMBMCAgTLFw0x
NzAxMjQwOTM5MDNaMBMCAgTMFw0xNzAxMjQwOTM5MDNaMBMCAgT7Fw0xNzAxMjQw
OTM5MDNaMBMCAgT8Fw0xNzAxMjQwOTM5MDNaMBMCAgT9Fw0xNzAxMjQwOTM5MDRa
MBMCAgUWFw0xNzAxMjQwOTM5MDRaMBMCAgYDFw0xNzAxMjQwOTM5MDRaMBMCAgaM
Fw0xNzAxMjQwOTM5MDRaMBMCAgbTFw0xNzAxMjQwOTM5MDRaMBMCAggmFw0xNzAx
MjQwOTM5MDRaMBMCAggnFw0xNzAxMjQwOTM5MDRaMBMCAggoFw0xNzAxMjQwOTM5
MDRaMBMCAggpFw0xNzAxMjQwOTM5MDRaMBMCAggrFw0xNzAxMjQwOTM5MDRaMBMC
AggtFw0xNzAxMjQwOTM5MDRaMBMCAgguFw0xNzAxMjQwOTM5MDRaMBMCAggwFw0x
NzAxMjQwOTM5MDRaMBMCAggxFw0xNzAxMjQwOTM5MDVaMBMCAggyFw0xNzAxMjQw
OTM5MDVaMBMCAggzFw0xNzAxMjQwOTM5MDVaMBMCAgg0Fw0xNzAxMjQwOTM5MDVa
MBMCAgg1Fw0xNzAxMjQwOTM5MDVaMBMCAgg2Fw0xNzAxMjQwOTM5MDVaMBMCAgg3
Fw0xNzAxMjQwOTM5MDVaMBMCAgg4Fw0xNzAxMjQwOTM5MDVaMBMCAgg5Fw0xNzAx
MjQwOTM5MDVaMBMCAgg6Fw0xNzAxMjQwOTM5MDVaMBMCAgg7Fw0xNzAxMjQwOTM5
MDVaMBMCAgg8Fw0xNzAxMjQwOTM5MDVaMBMCAgg9Fw0xNzAxMjQwOTM5MDVaMBMC
Agg+Fw0xNzAxMjQwOTM5MDVaMBMCAgg/Fw0xNzAxMjQwOTM5MDVaMBMCAghAFw0x
NzAxMjQwOTM5MDVaMBMCAghHFw0xNzAxMjQwOTM5MDVaMBMCAghaFw0xNzAxMjQw
OTM5MDZaMBMCAghbFw0xNzAxMjQwOTM5MDZaMBMCAghkFw0xNzAxMjQwOTM5MDZa
MBMCAghrFw0xNzAxMjQwOTM5MDZaMBMCAgiLFw0xNzAxMjQwOTM5MDZaMBMCAgiZ
Fw0xNzAxMjQwOTM5MDZaMBMCAgilFw0xNzAxMjQwOTM5MDZaMBMCAgjAFw0xNzAx
MjQwOTM5MDZaMBMCAgjCFw0xNzAxMjQwOTM5MDZaMBMCAgjDFw0xNzAxMjQwOTM5
MDZaMBMCAgjEFw0xNzAxMjQwOTM5MDZaMBMCAgjlFw0xNzAxMjQwOTM5MDZaMBMC
AgjmFw0xNzAxMjQwOTM5MDZaMBMCAgjnFw0xNzAxMjQwOTM5MDZaMBMCAgjoFw0x
NzAxMjQwOTM5MDZaMBMCAgjxFw0xNzAxMjQwOTM5MDZaMBMCAgkvFw0xNzAxMjQw
OTM5MDZaMBMCAgkwFw0xNzAxMjQwOTM5MDdaMBMCAglAFw0xNzAxMjQwOTM5MDda
MBMCAglPFw0xNzAxMjQwOTM5MDdaMBMCAglVFw0xNzAxMjQwOTM5MDdaMBMCAglj
Fw0xNzAxMjQwOTM5MDdaMBMCAglrFw0xNzAxMjQwOTM5MDdaMBMCAgl+Fw0xNzAx
MjQwOTM5MDdaMBMCAgmSFw0xNzAxMjQwOTM5MDdaMBMCAgnFFw0xNzAxMjQwOTM5
MDdaMBMCAgnGFw0xNzAxMjQwOTM5MDdaMBMCAgndFw0xNzAxMjQwOTM5MDdaMBMC
AgnnFw0xNzAxMjQwOTM5MDdaMBMCAgnpFw0xNzAxMjQwOTM5MDdaMBMCAgnqFw0x
NzAxMjQwOTM5MDdaMBMCAgoLFw0xNzAxMjQwOTM5MDdaMBMCAgpGFw0xNzAxMjQw
OTM5MDdaMBMCAgpTFw0xNzAxMjQwOTM5MDdaMBMCAgqNFw0xNzAxMjQwOTM5MDha
MBMCAgqOFw0xNzAxMjQwOTM5MDhaMBMCAgqdFw0xNzAxMjQwOTM5MDhaMBMCAgqg
Fw0xNzAxMjQwOTM5MDhaMBMCAgq5Fw0xNzAxMjQwOTM5MDhaMBMCAgrDFw0xNzAx
MjQwOTQzMjhaMBMCAgsIFw0xNzAxMjQwOTM5MDhaMBMCAgssFw0xNzAxMjQwOTQz
MTJaMBMCAgtpFw0xNzAxMjQwOTM5MDhaMBMCAguFFw0xNzAxMjQwOTM5MDhaMBMC
AgvEFw0xNzAxMjQwOTM5MDhaMA0GCSqGSIb3DQEBCwUAA4IBAQAoTeEf4M7tUij1
u8EiVF84gL0sho5maUO3DU+O1RjNgk4w0dWifPAL2SA6+IC87vB++0+vC+316SFZ
2Taey2xnvy/o0+GyNGyzwuQ77CSEOzapwwgpe/umAqKP1V7ApqPqmenwr2H7mI5R
6JjFHb/U/YbDtmR5AKPGUIgZ0bOgF9F/oeGxNlxWnRCb1woPbpA0JMzOy2UGzDLE
LhItYsiBFx4Xadkx7PcJc2noWLiMQlYbfOKoiaLIVWh+EmSIMPTCeQl4KR/98ofz
8PTeaBYRyWE0+zjkSo2jRi04q8xRLkXyfVZeEg0JjyZ3JYEJmb0bTglagbF6zOrN
mpRrPmH1
-----END X509 CRL-----
EOF


my $crl = Crypt::OpenSSL::CA::X509_CRL->parse_CRL($pemcrl);
print $crl->dump;

print $crl->get_lastUpdate."\n";
print $crl->get_nextUpdate."\n";
print $crl->get_issuer_DN."\n";
$a = $crl->get_entryNumbers;
print dumper $a;

print $crl->get_entry_revoke_date(11)."\n";
print $crl->get_entry_serial(11)."\n";
print $crl->get_entry_count."\n";
#EOF
